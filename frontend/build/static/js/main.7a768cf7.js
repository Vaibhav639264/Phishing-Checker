/*! For license information please see main.7a768cf7.js.LICENSE.txt */
(()=>{"use strict";var e={4:(e,t,n)=>{var r=n(853),a=n(43),l=n(950);function o(e){var t="https://ac1d4513-2ed8-469e-a2c0-26e2c8368863.preview.emergentagent.com","/api");const At=function(){const[e,t]=(0,a.useState)(null),[n,r]=(0,a.useState)(null),[l,o]=(0,a.useState)(!1),[i,s]=(0,a.useState)(!1),[u,f]=(0,a.useState)([]),[d,p]=(0,a.useState)({client_id:"",client_secret:"",refresh_token:""}),[m,h]=(0,a.useState)({configured:!1,monitoring_active:!1}),[g,y]=(0,a.useState)({alert_email:"",check_interval:60}),[b,v]=(0,a.useState)(!1),[w,k]=(0,a.useState)(!1),[S,x]=(0,a.useState)(null);(0,a.useEffect)((()=>{E(),N()}),[]);const E=async()=>{try{const e=await jt.get("".concat(Lt,"/analyses"));f(e.data.slice(0,5))}catch(e){console.error("Error fetching analyses:",e)}},N=async()=>{try{const e=await jt.get("".concat(Lt,"/gmail/status"));h(e.data)}catch(e){console.error("Error checking Gmail status:",e)}},C=e=>{e.preventDefault(),e.stopPropagation(),"dragenter"===e.type||"dragover"===e.type?s(!0):"dragleave"===e.type&&s(!1)},_=e=>{switch(e){case"CRITICAL":return"text-red-600 bg-red-100";case"HIGH":return"text-orange-600 bg-orange-100";case"MEDIUM":return"text-yellow-600 bg-yellow-100";case"LOW":return"text-green-600 bg-green-100";default:return"text-gray-600 bg-gray-100"}};return(0,zt.jsxs)("div",{className:"min-h-screen bg-gray-50",children:[(0,zt.jsx)("div",{className:"bg-white shadow-sm border-b",children:(0,zt.jsx)("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:(0,zt.jsx)("div",{className:"py-6",children:(0,zt.jsxs)("div",{className:"flex items-center",children:[(0,zt.jsx)("div",{className:"flex-shrink-0",children:(0,zt.jsx)("div",{className:"w-10 h-10 bg-blue-600 rounded-lg flex items-center justify-center",children:(0,zt.jsx)("span",{className:"text-white font-bold text-xl",children:"\ud83d\udee1\ufe0f"})})}),(0,zt.jsxs)("div",{className:"ml-4",children:[(0,zt.jsx)("h1",{className:"text-2xl font-bold text-gray-900",children:"Email Phishing Detector"}),(0,zt.jsx)("p",{className:"text-sm text-gray-600",children:"Advanced AI-powered email security analysis"})]})]})})})}),(0,zt.jsxs)("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[(0,zt.jsx)("div",{className:"mb-6 bg-white rounded-xl shadow-sm border border-gray-200 p-4",children:(0,zt.jsxs)("div",{className:"flex items-center justify-between",children:[(0,zt.jsxs)("div",{className:"flex items-center",children:[(0,zt.jsx)("div",{className:"w-3 h-3 rounded-full mr-3 ".concat(m.configured?"bg-green-500":"bg-red-500")}),(0,zt.jsxs)("div",{children:[(0,zt.jsxs)("h3",{className:"font-medium text-gray-900",children:["Gmail Integration ",m.configured?"Connected":"Not Connected"]}),(0,zt.jsx)("p",{className:"text-sm text-gray-600",children:m.monitoring_active?"\ud83d\udfe2 Real-time monitoring active":"\u23f8\ufe0f Monitoring inactive"})]})]}),(0,zt.jsxs)("div",{className:"flex space-x-2",children:[(0,zt.jsx)("button",{onClick:()=>v(!b),className:"px-3 py-1 text-sm bg-blue-100 text-blue-700 rounded-lg hover:bg-blue-200",children:"Setup"}),m.configured&&(0,zt.jsxs)(zt.Fragment,{children:[(0,zt.jsxs)("button",{onClick:m.monitoring_active?async()=>{try{o(!0);const e=await jt.post("".concat(Lt,"/gmail/stop-monitoring"));alert(e.data.message),await N()}catch(n){var e,t;alert("Failed to stop monitoring: ".concat((null===(e=n.response)||void 0===e||null===(t=e.data)||void 0===t?void 0:t.detail)||n.message))}finally{o(!1)}}:async()=>{try{o(!0);const e=await jt.post("".concat(Lt,"/gmail/start-monitoring"),g);alert(e.data.message),await N()}catch(n){var e,t;alert("Failed to start monitoring: ".concat((null===(e=n.response)||void 0===e||null===(t=e.data)||void 0===t?void 0:t.detail)||n.message))}finally{o(!1)}},disabled:l,className:"px-3 py-1 text-sm rounded-lg ".concat(m.monitoring_active?"bg-red-100 text-red-700 hover:bg-red-200":"bg-green-100 text-green-700 hover:bg-green-200"),children:[m.monitoring_active?"Stop":"Start"," Monitoring"]}),(0,zt.jsx)("button",{onClick:async()=>{try{k(!0);const e=await jt.post("".concat(Lt,"/gmail/manual-scan"),{max_emails:50});x(e.data.results),await E()}catch(n){var e,t;alert("Manual scan failed: ".concat((null===(e=n.response)||void 0===e||null===(t=e.data)||void 0===t?void 0:t.detail)||n.message))}finally{k(!1)}},disabled:w,className:"px-3 py-1 text-sm bg-purple-100 text-purple-700 rounded-lg hover:bg-purple-200",children:w?"Scanning...":"Manual Scan"})]})]})]})}),b&&(0,zt.jsxs)("div",{className:"mb-6 bg-white rounded-xl shadow-sm border border-gray-200 p-6",children:[(0,zt.jsx)("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Gmail API Setup"}),(0,zt.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 mb-4",children:[(0,zt.jsxs)("div",{children:[(0,zt.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Client ID"}),(0,zt.jsx)("input",{type:"text",value:d.client_id,onChange:e=>p(c(c({},d),{},{client_id:e.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"Google Cloud Console Client ID"})]}),(0,zt.jsxs)("div",{children:[(0,zt.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Client Secret"}),(0,zt.jsx)("input",{type:"password",value:d.client_secret,onChange:e=>p(c(c({},d),{},{client_secret:e.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"Google Cloud Console Client Secret"})]})]}),(0,zt.jsxs)("div",{className:"mb-4",children:[(0,zt.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Refresh Token (Optional)"}),(0,zt.jsx)("input",{type:"text",value:d.refresh_token,onChange:e=>p(c(c({},d),{},{refresh_token:e.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"Leave empty to generate new token"})]}),(0,zt.jsxs)("div",{className:"mb-4",children:[(0,zt.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Alert Email"}),(0,zt.jsx)("input",{type:"email",value:g.alert_email,onChange:e=>y(c(c({},g),{},{alert_email:e.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"your-email@gmail.com"})]}),(0,zt.jsx)("button",{onClick:async()=>{try{o(!0);const e=await jt.post("".concat(Lt,"/gmail/setup"),d);e.data.auth_url?alert("Please visit this URL to authorize: ".concat(e.data.auth_url)):(alert("Gmail setup successful!"),await N(),v(!1))}catch(n){var e,t;alert("Gmail setup failed: ".concat((null===(e=n.response)||void 0===e||null===(t=e.data)||void 0===t?void 0:t.detail)||n.message))}finally{o(!1)}},disabled:l||!d.client_id||!d.client_secret,className:"w-full py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed",children:l?"Setting up...":"Setup Gmail Integration"})]}),S&&(0,zt.jsxs)("div",{className:"mb-6 bg-white rounded-xl shadow-sm border border-gray-200 p-6",children:[(0,zt.jsx)("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Manual Scan Results"}),(0,zt.jsxs)("div",{className:"grid grid-cols-3 gap-4 mb-4",children:[(0,zt.jsxs)("div",{className:"text-center",children:[(0,zt.jsx)("div",{className:"text-2xl font-bold text-blue-600",children:S.total_scanned}),(0,zt.jsx)("div",{className:"text-sm text-gray-600",children:"Emails Scanned"})]}),(0,zt.jsxs)("div",{className:"text-center",children:[(0,zt.jsx)("div",{className:"text-2xl font-bold text-red-600",children:S.threats_found}),(0,zt.jsx)("div",{className:"text-sm text-gray-600",children:"Threats Found"})]}),(0,zt.jsxs)("div",{className:"text-center",children:[(0,zt.jsx)("div",{className:"text-2xl font-bold text-orange-600",children:S.actions_taken}),(0,zt.jsx)("div",{className:"text-sm text-gray-600",children:"Actions Taken"})]})]}),S.findings&&S.findings.length>0&&(0,zt.jsxs)("div",{className:"space-y-2",children:[(0,zt.jsx)("h4",{className:"font-medium text-gray-900",children:"Threat Details:"}),S.findings.slice(0,5).map(((e,t)=>(0,zt.jsxs)("div",{className:"border border-gray-200 rounded-lg p-3",children:[(0,zt.jsxs)("div",{className:"flex items-center justify-between mb-1",children:[(0,zt.jsx)("span",{className:"font-medium text-gray-900 truncate",children:e.subject}),(0,zt.jsx)("span",{className:"px-2 py-1 rounded text-xs ".concat(_(e.threat_level)),children:e.threat_level})]}),(0,zt.jsxs)("div",{className:"text-sm text-gray-600",children:["From: ",e.from]}),e.actions_taken&&(0,zt.jsx)("div",{className:"text-sm text-green-600 mt-1",children:"\u2705 Automated actions taken"})]},t)))]})]}),(0,zt.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-8",children:[(0,zt.jsxs)("div",{className:"lg:col-span-2",children:[(0,zt.jsxs)("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-6",children:[(0,zt.jsx)("h2",{className:"text-xl font-semibold text-gray-900 mb-4",children:"Upload Email for Analysis"}),e?(0,zt.jsxs)("div",{className:"border border-gray-200 rounded-xl p-6",children:[(0,zt.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,zt.jsxs)("div",{className:"flex items-center",children:[(0,zt.jsx)("div",{className:"w-10 h-10 bg-blue-100 rounded-lg flex items-center justify-center mr-3",children:(0,zt.jsx)("span",{className:"text-blue-600",children:"\ud83d\udcc4"})}),(0,zt.jsxs)("div",{children:[(0,zt.jsx)("p",{className:"font-medium text-gray-900",children:e.name}),(0,zt.jsxs)("p",{className:"text-sm text-gray-600",children:[(e.size/1024).toFixed(1)," KB"]})]})]}),(0,zt.jsx)("button",{onClick:()=>{t(null),r(null)},className:"text-gray-400 hover:text-gray-600",children:"\u2715"})]}),(0,zt.jsx)("button",{onClick:async()=>{if(!e)return;o(!0);const t=new FormData;t.append("file",e);try{const e=await jt.post("".concat(Lt,"/analyze-email"),t,{headers:{"Content-Type":"multipart/form-data"}});r(e.data.analysis),E()}catch(n){console.error("Error analyzing email:",n),r({error:"Failed to analyze email. Please try again.",threat_level:"UNKNOWN"})}finally{o(!1)}},disabled:l,className:"w-full py-3 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed transition-colors",children:l?(0,zt.jsxs)("div",{className:"flex items-center justify-center",children:[(0,zt.jsx)("div",{className:"animate-spin rounded-full h-5 w-5 border-b-2 border-white mr-2"}),"Analyzing Email..."]}):"Analyze Email"})]}):(0,zt.jsxs)("div",{className:"border-2 border-dashed rounded-xl p-8 text-center transition-colors ".concat(i?"border-blue-400 bg-blue-50":"border-gray-300 hover:border-gray-400"),onDragEnter:C,onDragLeave:C,onDragOver:C,onDrop:e=>{e.preventDefault(),e.stopPropagation(),s(!1),e.dataTransfer.files&&e.dataTransfer.files[0]&&t(e.dataTransfer.files[0])},children:[(0,zt.jsx)("div",{className:"text-6xl mb-4",children:"\ud83d\udce7"}),(0,zt.jsx)("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"Drop your email file here"}),(0,zt.jsx)("p",{className:"text-gray-600 mb-4",children:"Supports .eml, .msg, .txt files and plain text emails"}),(0,zt.jsx)("input",{type:"file",onChange:e=>{const n=e.target.files[0];t(n)},accept:".eml,.msg,.txt",className:"hidden",id:"file-upload"}),(0,zt.jsx)("label",{htmlFor:"file-upload",className:"inline-flex items-center px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 cursor-pointer transition-colors",children:"Choose File"})]})]}),n&&(0,zt.jsxs)("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-6 mt-6",children:[(0,zt.jsx)("h2",{className:"text-xl font-semibold text-gray-900 mb-4",children:"Analysis Results"}),(0,zt.jsxs)("div",{className:"inline-flex items-center px-4 py-2 rounded-full text-sm font-medium mb-4 ".concat(_(n.threat_level)),children:[(0,zt.jsx)("span",{className:"mr-2",children:(e=>{switch(e){case"CRITICAL":return"\ud83d\udea8";case"HIGH":return"\u26a0\ufe0f";case"MEDIUM":return"\u26a1";case"LOW":return"\u2705";default:return"\u2753"}})(n.threat_level)}),"Threat Level: ",n.threat_level]}),n.subject&&(0,zt.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 mb-6",children:[(0,zt.jsxs)("div",{children:[(0,zt.jsx)("h4",{className:"font-medium text-gray-900 mb-1",children:"Subject"}),(0,zt.jsx)("p",{className:"text-gray-600 text-sm",children:n.subject})]}),(0,zt.jsxs)("div",{children:[(0,zt.jsx)("h4",{className:"font-medium text-gray-900 mb-1",children:"From"}),(0,zt.jsx)("p",{className:"text-gray-600 text-sm",children:n.from})]})]}),(0,zt.jsxs)("div",{className:"space-y-4",children:[n.url_analysis&&n.url_analysis.length>0&&(0,zt.jsxs)("div",{className:"border border-red-200 rounded-lg p-4 bg-red-50",children:[(0,zt.jsx)("h4",{className:"font-medium text-red-900 mb-2",children:"\ud83d\udd17 URL Analysis"}),n.url_analysis.map(((e,t)=>(0,zt.jsxs)("div",{className:"text-sm text-red-800 mb-1",children:["\u2022 ",e.type,": ",e.original_url||e.url]},t)))]}),n.sender_analysis&&n.sender_analysis.length>0&&(0,zt.jsxs)("div",{className:"border border-orange-200 rounded-lg p-4 bg-orange-50",children:[(0,zt.jsx)("h4",{className:"font-medium text-orange-900 mb-2",children:"\ud83d\udc64 Sender Analysis"}),n.sender_analysis.map(((e,t)=>(0,zt.jsxs)("div",{className:"text-sm text-orange-800 mb-1",children:["\u2022 ",e.type,": ",e.suspected_brand||e.from]},t)))]}),n.social_engineering&&n.social_engineering.length>0&&(0,zt.jsxs)("div",{className:"border border-yellow-200 rounded-lg p-4 bg-yellow-50",children:[(0,zt.jsx)("h4",{className:"font-medium text-yellow-900 mb-2",children:"\ud83e\udde0 Social Engineering"}),n.social_engineering.map(((e,t)=>(0,zt.jsxs)("div",{className:"text-sm text-yellow-800 mb-1",children:["\u2022 ",e.type,": ",e.pattern||e.greeting]},t)))]}),n.attachment_analysis&&n.attachment_analysis.length>0&&(0,zt.jsxs)("div",{className:"border border-purple-200 rounded-lg p-4 bg-purple-50",children:[(0,zt.jsx)("h4",{className:"font-medium text-purple-900 mb-2",children:"\ud83d\udcce Attachment Analysis"}),n.attachment_analysis.map(((e,t)=>(0,zt.jsxs)("div",{className:"text-sm text-purple-800 mb-1",children:["\u2022 ",e.type,": ",e.filename]},t)))]}),n.llm_analysis&&(0,zt.jsxs)("div",{className:"border border-blue-200 rounded-lg p-4 bg-blue-50",children:[(0,zt.jsx)("h4",{className:"font-medium text-blue-900 mb-2",children:"\ud83e\udd16 AI Analysis"}),(0,zt.jsx)("div",{className:"text-sm text-blue-800 whitespace-pre-wrap",children:n.llm_analysis})]})]})]})]}),(0,zt.jsxs)("div",{className:"lg:col-span-1",children:[(0,zt.jsxs)("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-6",children:[(0,zt.jsx)("h2",{className:"text-xl font-semibold text-gray-900 mb-4",children:"Recent Analyses"}),0===u.length?(0,zt.jsx)("p",{className:"text-gray-600 text-sm",children:"No analyses yet"}):(0,zt.jsx)("div",{className:"space-y-3",children:u.map((e=>(0,zt.jsxs)("div",{className:"border border-gray-200 rounded-lg p-3",children:[(0,zt.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,zt.jsx)("p",{className:"font-medium text-gray-900 text-sm truncate",children:e.filename}),(0,zt.jsx)("span",{className:"px-2 py-1 rounded text-xs ".concat(_(e.threat_level)),children:e.threat_level})]}),(0,zt.jsx)("p",{className:"text-xs text-gray-600",children:new Date(e.timestamp).toLocaleDateString()})]},e.id)))})]}),(0,zt.jsxs)("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-6 mt-6",children:[(0,zt.jsx)("h3",{className:"font-semibold text-gray-900 mb-3",children:"Detection Features"}),(0,zt.jsxs)("div",{className:"space-y-2 text-sm text-gray-600",children:[(0,zt.jsxs)("div",{className:"flex items-center",children:[(0,zt.jsx)("span",{className:"mr-2",children:"\ud83d\udd17"}),"URL redirection analysis"]}),(0,zt.jsxs)("div",{className:"flex items-center",children:[(0,zt.jsx)("span",{className:"mr-2",children:"\ud83d\udc64"}),"Sender authenticity check"]}),(0,zt.jsxs)("div",{className:"flex items-center",children:[(0,zt.jsx)("span",{className:"mr-2",children:"\ud83e\udde0"}),"Social engineering detection"]}),(0,zt.jsxs)("div",{className:"flex items-center",children:[(0,zt.jsx)("span",{className:"mr-2",children:"\ud83d\udcce"}),"Malicious attachment scan"]}),(0,zt.jsxs)("div",{className:"flex items-center",children:[(0,zt.jsx)("span",{className:"mr-2",children:"\ud83e\udd16"}),"AI-powered analysis"]})]})]})]})]})]})]})};l.createRoot(document.getElementById("root")).render((0,zt.jsx)(a.StrictMode,{children:(0,zt.jsx)(At,{})}))})();
//# sourceMappingURL=main.7a768cf7.js.map